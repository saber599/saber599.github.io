<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="Hexo Theme Keep"><meta name="description" content="Hexo Theme Keep"><meta name="author" content="saber599"><title>Seatunnel测试 | Saber</title><link rel="stylesheet" href="/css/style.css"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/saber599/image@main/blog/Fate_Zero - Saber by tseon on DeviantArt.6iv4bhancmo0.png"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.2/source/css/font-awesome.min.css"><script id="hexo-configurations">let KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"saber599.github.io",root:"/",language:"zh-CN",path:"search.json"},KEEP.theme_config={toc:{enable:!0,number:!1,expand_all:!1,init_open:!1},style:{primary_color:"#0066CC",avatar:"https://cdn.jsdelivr.net/gh/saber599/image@main/blog/saber.5n8z30d8b9g0.jpg",favicon:"https://cdn.jsdelivr.net/gh/saber599/image@main/blog/Fate_Zero - Saber by tseon on DeviantArt.6iv4bhancmo0.png",article_img_align:"left",left_side_width:"260px",content_max_width:"920px",hover:{shadow:!0,scale:!0},first_screen:{enable:!0,background_img:"/images/bg.svg",description:"Good good study, day day up."},scroll:{progress_bar:{enable:!0},percent:{enable:!0}}},local_search:{enable:!0,preload:!0},code_copy:{enable:!0,style:"default"},pjax:{enable:!0},lazyload:{enable:!1},version:"3.4.2"},KEEP.language_ago={second:"%s 秒前",minute:"%s 分钟前",hour:"%s 小时前",day:"%s 天前",week:"%s 周前",month:"%s 月前",year:"%s 年前"}</script><meta name="generator" content="Hexo 5.4.0"></head><body><div class="progress-bar-container"><span class="scroll-progress-bar"></span> <span class="pjax-progress-bar"></span> <span class="pjax-progress-icon"><i class="fas fa-circle-notch fa-spin"></i></span></div><main class="page-container"><div class="page-main-content"><div class="page-main-content-top"><header class="header-wrapper"><div class="header-content"><div class="left"><a class="logo-title" href="/">Saber</a></div><div class="right"><div class="pc"><ul class="menu-list"><li class="menu-item"><a href="/">首页</a></li><li class="menu-item"><a href="/archives">归档</a></li><li class="menu-item"><a href="/about">关于</a></li><li class="menu-item search search-popup-trigger"><i class="fas fa-search"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class="menu-bar-middle"></div></div></div></div></div><div class="header-drawer"><ul class="drawer-menu-list"><li class="drawer-menu-item flex-center"><a href="/">首页</a></li><li class="drawer-menu-item flex-center"><a href="/archives">归档</a></li><li class="drawer-menu-item flex-center"><a href="/about">关于</a></li></ul></div><div class="window-mask"></div></header></div><div class="page-main-content-middle"><div class="main-content"><div class="fade-in-down-animation"><div class="article-content-container"><div class="article-title"><span class="title-hover-animation">Seatunnel测试</span></div><div class="article-header"><div class="avatar"><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog/saber.5n8z30d8b9g0.jpg"></div><div class="info"><div class="author"><span class="name">saber599</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fas fa-edit"></i>&nbsp;2023-06-25 15:13:02 </span><span class="article-categories article-meta-item"><i class="fas fa-folder"></i>&nbsp;<ul><li><a href="/categories/Seatunnel/">Seatunnel</a>&nbsp;</li></ul></span><span class="article-tags article-meta-item"><i class="fas fa-tags"></i>&nbsp;<ul><li><a href="/tags/sftp/">sftp</a>&nbsp;</li><li>| <a href="/tags/mysql/">mysql</a>&nbsp;</li><li>| <a href="/tags/kafka/">kafka</a>&nbsp;</li><li>| <a href="/tags/hive/">hive</a>&nbsp;</li></ul></span><span class="article-pv article-meta-item"><i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body"><h3 id="1-前置条件"><a href="#1-前置条件" class="headerlink" title="1. 前置条件"></a>1. 前置条件</h3><ul><li>seatunnel</li><li>hadoop，检查点会用到hdfs，没有也能看到效果</li><li>本地hadoop，需要hadoop_home，没有也能看到效果</li></ul><h3 id="2-sftp-gt-hive"><a href="#2-sftp-gt-hive" class="headerlink" title="2. sftp-&gt;hive"></a>2. sftp-&gt;hive</h3><h4 id="2-1-场景说明"><a href="#2-1-场景说明" class="headerlink" title="2.1 场景说明"></a>2.1 场景说明</h4><pre><code>将ftp文件同步到hive分区表中，根据ftp文件内容字段动态保存。
</code></pre><h4 id="2-2-准备"><a href="#2-2-准备" class="headerlink" title="2.2 准备"></a>2.2 准备</h4><ol><li><p>环境准备</p><ol><li>seatunnel-2.3.1</li><li>hadoop-3.3.2</li><li>hive-3.1.2</li><li>sftp服务器</li></ol></li><li><p>ftp文件内容</p></li></ol><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">user_id#user_name#create_time#province_id</span><br><span class="line">1#张三#2023-06-24 19:59:23#11</span><br><span class="line">2#李四#2023-06-23 18:50:20#11</span><br><span class="line">3#王五#2023-06-24 19:59:23#12</span><br><span class="line">4#赵六#2023-06-24 20:03:01#11</span><br></pre></td></tr></table></figure><ol start="3"><li>hive建表sql</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> user_info(</span><br><span class="line">        user_id string comment <span class="string">&#x27;用户id&#x27;</span>,</span><br><span class="line">        user_name string comment <span class="string">&#x27;用户名&#x27;</span>,</span><br><span class="line">        create_time <span class="type">timestamp</span> comment <span class="string">&#x27;创建时间&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;用户信息&#x27;</span></span><br><span class="line">partitioned <span class="keyword">by</span> (province_id string, create_day <span class="type">date</span>)</span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> <span class="string">&#x27;#&#x27;</span></span><br><span class="line">location <span class="string">&#x27;/hive/warehouse/dev.db/user_info&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="2-3-seatunnel配置文件编写"><a href="#2-3-seatunnel配置文件编写" class="headerlink" title="2.3 seatunnel配置文件编写"></a>2.3 seatunnel配置文件编写</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">env &#123;</span><br><span class="line">  # You can set engine configuration here</span><br><span class="line">  execution.parallelism = 1</span><br><span class="line">  job.mode = &quot;BATCH&quot;</span><br><span class="line">  checkpoint.interval = 5000</span><br><span class="line">  execution.checkpoint.data-uri = &quot;hdfs://192.168.10.222:9000/checkpoint&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">source &#123;</span><br><span class="line">    # https://seatunnel.apache.org/docs/connector-v2/source/FtpFile</span><br><span class="line">    SftpFile &#123;</span><br><span class="line">        path = &quot;/opt/upload/user_info.txt&quot;</span><br><span class="line">        host = &quot;192.168.10.222&quot;</span><br><span class="line">        port = 22</span><br><span class="line">        user = hadoop</span><br><span class="line">        password = hadoop</span><br><span class="line">        file_format_type = &quot;text&quot;</span><br><span class="line">        schema = &#123;</span><br><span class="line">            fields &#123;</span><br><span class="line">              user_id = string</span><br><span class="line">              user_name = string</span><br><span class="line">              create_time = TIMESTAMP</span><br><span class="line">              province_id = string</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        delimiter = &quot;#&quot;</span><br><span class="line">        datetime_format = &quot;yyyy-MM-dd HH:mm:ss&quot;</span><br><span class="line">        skip_header_row_number = 1</span><br><span class="line">        result_table_name = tmp</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">transform &#123;</span><br><span class="line">  # https://seatunnel.apache.org/docs/transform-v2/sql</span><br><span class="line">  # https://seatunnel.apache.org/docs/transform-v2/sql-functions</span><br><span class="line">    Sql &#123;</span><br><span class="line">        source_table_name = &quot;tmp&quot;</span><br><span class="line">        result_table_name = &quot;tmp2&quot;</span><br><span class="line">        query = &quot;select user_id, user_name, create_time, TO_CHAR(create_time, &#x27;yyyy-MM-dd&#x27;) create_day, province_id  from tmp&quot;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sink &#123;</span><br><span class="line">  # https://seatunnel.apache.org/docs/connector-v2/sink/HdfsFile</span><br><span class="line">  HdfsFile &#123;</span><br><span class="line">      source_table_name = &quot;tmp2&quot;</span><br><span class="line">      fs.defaultFS = &quot;hdfs://192.168.10.222:9000&quot;</span><br><span class="line">      path = &quot;/hive/warehouse/dev.db/user_info&quot;</span><br><span class="line">      file_format = &quot;text&quot;</span><br><span class="line">      field_delimiter = &quot;\t&quot;</span><br><span class="line">      have_partition = true</span><br><span class="line">      partition_by = [&quot;province_id&quot;,&quot;create_day&quot;]</span><br><span class="line">      partition_dir_expression = &quot;$&#123;k0&#125;=$&#123;v0&#125;/$&#123;k1&#125;=$&#123;v1&#125;&quot;</span><br><span class="line">      is_partition_field_write_in_file = true</span><br><span class="line">      custom_filename = true</span><br><span class="line">      file_name_expression = &quot;$&#123;transactionId&#125;_$&#123;now&#125;&quot;</span><br><span class="line">      filename_time_format = &quot;yyyy.MM.dd&quot;</span><br><span class="line">      sink_columns = [&quot;user_id&quot;,&quot;user_name&quot;,&quot;create_time&quot;,&quot;create_day&quot;,&quot;province_id&quot;]</span><br><span class="line">      is_enable_transaction = true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-4-多种方式加载数据到hive"><a href="#2-4-多种方式加载数据到hive" class="headerlink" title="2.4 多种方式加载数据到hive"></a>2.4 多种方式加载数据到hive</h4><ol><li>上传数据到指定分区目录后修复，将没有创建分区的目录创建对应分区</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msck repair <span class="keyword">table</span> user_info;</span><br></pre></td></tr></table></figure><ol start="2"><li>事先/是否创建分区即可</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> user_info <span class="keyword">add</span> <span class="keyword">partition</span>(province_id<span class="operator">=</span><span class="string">&#x27;11&#x27;</span>,create_day<span class="operator">=</span><span class="string">&#x27;2023-06-23&#x27;</span>);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> user_info <span class="keyword">add</span> <span class="keyword">partition</span>(province_id<span class="operator">=</span><span class="string">&#x27;11&#x27;</span>,create_day<span class="operator">=</span><span class="string">&#x27;2023-06-24&#x27;</span>);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> user_info <span class="keyword">add</span> <span class="keyword">partition</span>(province_id<span class="operator">=</span><span class="string">&#x27;12&#x27;</span>,create_day<span class="operator">=</span><span class="string">&#x27;2023-06-24&#x27;</span>);</span><br></pre></td></tr></table></figure><ol start="3"><li>手动执行load语句load数据</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load data inpath <span class="string">&#x27;hdfs://192.168.10.222:9000/hive/warehouse/dev.db/user_info/province_id=11/create_day=2023-06-23/	T_724967131367604225_a452435c6e_0_1_2023.06.24_0.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> user_info <span class="keyword">partition</span>(province_id<span class="operator">=</span><span class="string">&#x27;11&#x27;</span>,create_day<span class="operator">=</span><span class="string">&#x27;2023-06-23&#x27;</span>);</span><br></pre></td></tr></table></figure><h4 id="2-5-执行结果"><a href="#2-5-执行结果" class="headerlink" title="2.5 执行结果"></a>2.5 执行结果</h4><ol><li><p>seatunnel执行结果<br><a class="link" target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/be57584da985150eec5d47fa5dfa0a82.4i8swjae99c0.webp">https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel测试用例/be57584da985150eec5d47fa5dfa0a82.4i8swjae99c0.webp<i class="fas fa-external-link-alt"></i></a><br><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/be57584da985150eec5d47fa5dfa0a82.4i8swjae99c0.webp" alt="seatunnel执行结果"></p></li><li><p>hdfs结果</p></li></ol><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/e1ed2e90dfccd8868cd01a6853374bcd.19floftx511c.webp" alt="截图"></p><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/5fc1ceb30701e2b618a3d4c5608e3d35.z69hrpwp1uo.webp" alt="截图"></p><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/facd810a3aaad6837cfd259e6cfca6d6.6pk28g8mke00.webp" alt="截图"></p><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/efd1c19ed4e59310c93db005a1265f9b.2o92a5hplhk0.webp" alt="截图"></p><ol start="3"><li>hive查询结果</li></ol><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/afb437d190f6fe6eebc37ca4afefa62d.392rnqm12i40.webp" alt="截图"></p><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/96abe39892bc5c0d9915773b796609fe.5usfuvniozc0.webp" alt="截图"></p><h3 id="3-kafka-gt-hive"><a href="#3-kafka-gt-hive" class="headerlink" title="3. kafka-&gt;hive"></a>3. kafka-&gt;hive</h3><h4 id="3-1-场景说明"><a href="#3-1-场景说明" class="headerlink" title="3.1 场景说明"></a>3.1 场景说明</h4><p>将kafka队列数据同步到hive分区表中，根据消息体字段动态保存。</p><h4 id="3-2-准备"><a href="#3-2-准备" class="headerlink" title="3.2 准备"></a>3.2 准备</h4><ol><li><p>环境准备</p><ol><li>seatunnel-2.3.1</li><li>hadoop-3.3.2</li><li>hive-3.1.2</li><li>kafka_2.11-0.11.0.1</li></ol></li><li><p>kafka内容</p></li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;user_id&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="attr">&quot;user_name&quot;</span>:<span class="string">&quot;张三&quot;</span>,<span class="attr">&quot;create_time&quot;</span>:<span class="string">&quot;2023-06-24 19:59:23&quot;</span>,<span class="attr">&quot;province_id&quot;</span>:<span class="string">&quot;12&quot;</span>&#125;</span><br><span class="line">&#123;<span class="attr">&quot;user_id&quot;</span>:<span class="string">&quot;2&quot;</span>,<span class="attr">&quot;user_name&quot;</span>:<span class="string">&quot;李四&quot;</span>,<span class="attr">&quot;create_time&quot;</span>:<span class="string">&quot;2023-06-23 18:50:20&quot;</span>,<span class="attr">&quot;province_id&quot;</span>:<span class="string">&quot;11&quot;</span>&#125;</span><br><span class="line">&#123;<span class="attr">&quot;user_id&quot;</span>:<span class="string">&quot;3&quot;</span>,<span class="attr">&quot;user_name&quot;</span>:<span class="string">&quot;王五&quot;</span>,<span class="attr">&quot;create_time&quot;</span>:<span class="string">&quot;2023-06-24 19:59:23&quot;</span>,<span class="attr">&quot;province_id&quot;</span>:<span class="string">&quot;12&quot;</span>&#125;</span><br><span class="line">&#123;<span class="attr">&quot;user_id&quot;</span>:<span class="string">&quot;4&quot;</span>,<span class="attr">&quot;user_name&quot;</span>:<span class="string">&quot;赵六&quot;</span>,<span class="attr">&quot;create_time&quot;</span>:<span class="string">&quot;2023-06-24 20:03:01&quot;</span>,<span class="attr">&quot;province_id&quot;</span>:<span class="string">&quot;11&quot;</span>&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>hive建表sql</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> user_info_kafka(</span><br><span class="line">        user_id string comment <span class="string">&#x27;用户id&#x27;</span>,</span><br><span class="line">        user_name string comment <span class="string">&#x27;用户名&#x27;</span>,</span><br><span class="line">        create_time <span class="type">timestamp</span> comment <span class="string">&#x27;创建时间&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;用户信息&#x27;</span></span><br><span class="line">partitioned <span class="keyword">by</span> (province_id string, create_day <span class="type">date</span>)</span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> <span class="string">&#x27;#&#x27;</span></span><br><span class="line">location <span class="string">&#x27;/hive/warehouse/dev.db/user_info_kafka&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="3-3-seatunnel配置文件编写"><a href="#3-3-seatunnel配置文件编写" class="headerlink" title="3.3 seatunnel配置文件编写"></a>3.3 seatunnel配置文件编写</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">env &#123;</span><br><span class="line">  # You can set engine configuration here</span><br><span class="line">  execution.parallelism &#x3D; 1</span><br><span class="line">  job.mode &#x3D; &quot;STREAMING&quot;</span><br><span class="line">  # job.mode &#x3D; &quot;BATCH&quot;</span><br><span class="line">  checkpoint.interval &#x3D; 5000</span><br><span class="line">  execution.checkpoint.data-uri &#x3D; &quot;hdfs:&#x2F;&#x2F;192.168.10.222:9000&#x2F;checkpoint&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">source &#123;</span><br><span class="line">    # https:&#x2F;&#x2F;seatunnel.apache.org&#x2F;docs&#x2F;connector-v2&#x2F;source&#x2F;kafka</span><br><span class="line">    Kafka &#123;</span><br><span class="line">        result_table_name &#x3D; &quot;tmp&quot;</span><br><span class="line">        schema &#x3D; &#123;</span><br><span class="line">          fields &#123;</span><br><span class="line">              user_id &#x3D; string</span><br><span class="line">              user_name &#x3D; string</span><br><span class="line">              create_time &#x3D; string</span><br><span class="line">              province_id &#x3D; string</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        # consumer.group &#x3D; &quot;test_group&quot;</span><br><span class="line">        # format &#x3D; text</span><br><span class="line">        datetime_format &#x3D; &quot;yyyy-MM-dd HH:mm:ss&quot;</span><br><span class="line">        format &#x3D; json</span><br><span class="line">        # field_delimiter &#x3D; &quot;#&quot;</span><br><span class="line">        topic &#x3D; &quot;user_info_topic&quot;</span><br><span class="line">        bootstrap.servers &#x3D; &quot;192.168.10.222:9092&quot;</span><br><span class="line">#        kafka.config &#x3D; &#123;</span><br><span class="line">#              client.id &#x3D; client_1</span><br><span class="line">#              max.poll.records &#x3D; 500</span><br><span class="line">#              auto.offset.reset &#x3D; &quot;earliest&quot;</span><br><span class="line">#              enable.auto.commit &#x3D; &quot;false&quot;</span><br><span class="line">#            &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">transform &#123;</span><br><span class="line">  # https:&#x2F;&#x2F;seatunnel.apache.org&#x2F;docs&#x2F;transform-v2&#x2F;sql</span><br><span class="line">  # https:&#x2F;&#x2F;seatunnel.apache.org&#x2F;docs&#x2F;transform-v2&#x2F;sql-functions</span><br><span class="line">    Sql &#123;</span><br><span class="line">        source_table_name &#x3D; &quot;tmp&quot;</span><br><span class="line">        result_table_name &#x3D; &quot;tmp2&quot;</span><br><span class="line">        query &#x3D; &quot;select user_id, user_name, create_time, SUBSTR(create_time, 0,10) create_day, province_id  from tmp&quot;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sink &#123;</span><br><span class="line">  # https:&#x2F;&#x2F;seatunnel.apache.org&#x2F;docs&#x2F;connector-v2&#x2F;sink&#x2F;HdfsFile</span><br><span class="line">  HdfsFile &#123;</span><br><span class="line">      source_table_name &#x3D; &quot;tmp2&quot;</span><br><span class="line">      fs.defaultFS &#x3D; &quot;hdfs:&#x2F;&#x2F;192.168.10.222:9000&quot;</span><br><span class="line">      path &#x3D; &quot;&#x2F;hive&#x2F;warehouse&#x2F;dev.db&#x2F;user_info_kafka&quot;</span><br><span class="line">      file_format &#x3D; &quot;text&quot;</span><br><span class="line">      field_delimiter &#x3D; &quot;\t&quot;</span><br><span class="line">      have_partition &#x3D; true</span><br><span class="line">      partition_by &#x3D; [&quot;province_id&quot;,&quot;create_day&quot;]</span><br><span class="line">      partition_dir_expression &#x3D; &quot;$&#123;k0&#125;&#x3D;$&#123;v0&#125;&#x2F;$&#123;k1&#125;&#x3D;$&#123;v1&#125;&quot;</span><br><span class="line">      is_partition_field_write_in_file &#x3D; true</span><br><span class="line">      custom_filename &#x3D; true</span><br><span class="line">      file_name_expression &#x3D; &quot;$&#123;transactionId&#125;_$&#123;now&#125;&quot;</span><br><span class="line">      filename_time_format &#x3D; &quot;yyyy.MM.dd&quot;</span><br><span class="line">      sink_columns &#x3D; [&quot;user_id&quot;,&quot;user_name&quot;,&quot;create_time&quot;,&quot;create_day&quot;,&quot;province_id&quot;]</span><br><span class="line">      is_enable_transaction &#x3D; true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-4-发送kafka消息"><a href="#3-4-发送kafka消息" class="headerlink" title="3.4 发送kafka消息"></a>3.4 发送kafka消息</h4><ol><li>启动zk</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup bin/zookeeper-server-start.sh config/zookeeper.properties &gt;&gt; zookeeper.nohup.out &amp;</span><br></pre></td></tr></table></figure><ol start="2"><li>启动kafka</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup bin/kafka-server-start.sh config/server.properties &gt;&gt; producer.nohup.out &amp;</span><br></pre></td></tr></table></figure><ol start="3"><li>创建topic</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic user_info_topic</span><br></pre></td></tr></table></figure><ol start="4"><li>发送消息</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin&#x2F;kafka-console-producer.sh --broker-list localhost:9092 --topic user_info_topic</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/ad56cd149bc219a9c2982a38d93b6c6b.57i0p9ob0fg0.webp" alt="截图"></p><h4 id="3-5-多种方式加载数据到hive"><a href="#3-5-多种方式加载数据到hive" class="headerlink" title="3.5 多种方式加载数据到hive"></a>3.5 多种方式加载数据到hive</h4><p>同2.4</p><h4 id="3-6-执行结果"><a href="#3-6-执行结果" class="headerlink" title="3.6 执行结果"></a>3.6 执行结果</h4><ol><li>seatunnel执行结果</li></ol><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/7badb425842be610d964d00965213ac9.3fze1ch7xoi0.webp" alt="截图"></p><ol start="2"><li>hdfs结果</li></ol><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/d2f7b7b8b0d8748f62bde8ff3fb64186.1lf5sc0z1md.webp" alt="截图"></p><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/79091225ba0ff9d89c365b08157803df.3t7d4xwm4x40.webp" alt="截图"></p><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/1f4b9c4098a0129b895fc4e2eaf4140c.72oamw2uyh80.webp" alt="截图"></p><ol start="3"><li>hive查询结果</li></ol><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/a4c1a33246750f1fa10966b7069ea9c3.4yvuvtg4y6o0.webp" alt="截图"></p><h3 id="4-rdb-gt-hive"><a href="#4-rdb-gt-hive" class="headerlink" title="4. rdb-&gt;hive"></a>4. rdb-&gt;hive</h3><h4 id="4-1-场景说明"><a href="#4-1-场景说明" class="headerlink" title="4.1 场景说明"></a>4.1 场景说明</h4><p>将关系型数据库数据同步到hive分区表中，根据消息体字段动态保存，示例选用mysql-&gt;hive。</p><h4 id="4-2-准备"><a href="#4-2-准备" class="headerlink" title="4.2 准备"></a>4.2 准备</h4><ol><li>环境准备<ol><li>seatunnel-2.3.1</li><li>hadoop-3.3.2</li><li>hive-3.1.2</li><li>mysql-8.0.32</li></ol></li><li>mysql建表sql</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `user_info`  (</span><br><span class="line">  `user_id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;用户id&#x27;</span>,</span><br><span class="line">  `user_name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户名&#x27;</span>,</span><br><span class="line">  `create_time` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `province_id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;省份id&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`user_id`)</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4 COMMENT <span class="operator">=</span> <span class="string">&#x27;用户信息&#x27;</span>;</span><br></pre></td></tr></table></figure><ol start="3"><li>mysql表内容<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `user_info` (`user_id`, `user_name`, `create_time`, `province_id`) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;2023-06-24 19:59:23&#x27;</span>, <span class="number">12</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `user_info` (`user_id`, `user_name`, `create_time`, `province_id`) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;2023-06-23 18:50:20&#x27;</span>, <span class="number">11</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `user_info` (`user_id`, `user_name`, `create_time`, `province_id`) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="string">&#x27;2023-06-24 19:59:23&#x27;</span>, <span class="number">12</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `user_info` (`user_id`, `user_name`, `create_time`, `province_id`) <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;赵六&#x27;</span>, <span class="string">&#x27;2023-06-24 20:03:01&#x27;</span>, <span class="number">11</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>hive建表sql</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> user_info_mysql(</span><br><span class="line">        user_id string comment <span class="string">&#x27;用户id&#x27;</span>,</span><br><span class="line">        user_name string comment <span class="string">&#x27;用户名&#x27;</span>,</span><br><span class="line">        create_time <span class="type">timestamp</span> comment <span class="string">&#x27;创建时间&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;用户信息&#x27;</span></span><br><span class="line">partitioned <span class="keyword">by</span> (province_id string, create_day <span class="type">date</span>)</span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> <span class="string">&#x27;#&#x27;</span></span><br><span class="line">location <span class="string">&#x27;/hive/warehouse/dev.db/user_info_mysql&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="4-3-seatunnel配置文件编写"><a href="#4-3-seatunnel配置文件编写" class="headerlink" title="4.3 seatunnel配置文件编写"></a>4.3 seatunnel配置文件编写</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">env &#123;</span><br><span class="line">  # You can set engine configuration here</span><br><span class="line">  execution.parallelism = 1</span><br><span class="line">  job.mode = &quot;BATCH&quot;</span><br><span class="line">  checkpoint.interval = 5000</span><br><span class="line">  execution.checkpoint.data-uri = &quot;hdfs://192.168.10.222:9000/checkpoint&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">source &#123;</span><br><span class="line">    # https://seatunnel.apache.org/docs/connector-v2/source/Mysql</span><br><span class="line">    Jdbc &#123;</span><br><span class="line">        url = &quot;jdbc:mysql://192.168.10.222:3306/seatunnel_test&quot;</span><br><span class="line">        driver = &quot;com.mysql.cj.jdbc.Driver&quot;</span><br><span class="line">        connection_check_timeout_sec = 100</span><br><span class="line">        user = &quot;root&quot;</span><br><span class="line">        password = &quot;root&quot;</span><br><span class="line">        query = &quot;select user_id,user_name,create_time,date_format(create_time, &#x27;%Y-%m-%d&#x27;) create_day,province_id from user_info&quot;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sink &#123;</span><br><span class="line">  # https://seatunnel.apache.org/docs/connector-v2/sink/HdfsFile</span><br><span class="line">  HdfsFile &#123;</span><br><span class="line">      fs.defaultFS = &quot;hdfs://192.168.10.222:9000&quot;</span><br><span class="line">      path = &quot;/hive/warehouse/dev.db/user_info_mysql&quot;</span><br><span class="line">      file_format = &quot;text&quot;</span><br><span class="line">      field_delimiter = &quot;\t&quot;</span><br><span class="line">      have_partition = true</span><br><span class="line">      partition_by = [&quot;province_id&quot;,&quot;create_day&quot;]</span><br><span class="line">      partition_dir_expression = &quot;$&#123;k0&#125;=$&#123;v0&#125;/$&#123;k1&#125;=$&#123;v1&#125;&quot;</span><br><span class="line">      is_partition_field_write_in_file = true</span><br><span class="line">      custom_filename = true</span><br><span class="line">      file_name_expression = &quot;$&#123;transactionId&#125;_$&#123;now&#125;&quot;</span><br><span class="line">      filename_time_format = &quot;yyyy.MM.dd&quot;</span><br><span class="line">      sink_columns = [&quot;user_id&quot;,&quot;user_name&quot;,&quot;create_time&quot;,&quot;create_day&quot;,&quot;province_id&quot;]</span><br><span class="line">      is_enable_transaction = true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-4-多种方式加载数据到hive"><a href="#4-4-多种方式加载数据到hive" class="headerlink" title="4.4 多种方式加载数据到hive"></a>4.4 多种方式加载数据到hive</h4><p>同2.4</p><h4 id="4-5-执行结果"><a href="#4-5-执行结果" class="headerlink" title="4.5 执行结果"></a>4.5 执行结果</h4><ol><li>seatunnel执行结果</li></ol><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/d7bd0449c1c90f4e1c1ca9fc72126092.4knqvland2m0.webp" alt="截图"></p><ol start="2"><li>hdfs结果</li></ol><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/2b449041fbec0aa42905962800142da2.32w8mlxyd880.webp" alt="截图"></p><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/c0ace8336b5ca372701e8027b8dbeae6.yx3u3mhfrcg.webp" alt="截图"></p><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/59b2efaab6ee8ea1076f14e8f18cf7a2.1tpf0xrod6u8.webp" alt="截图"></p><ol start="3"><li>hive查询结果</li></ol><p><img src="https://cdn.jsdelivr.net/gh/saber599/image@main/blog_images/seatunnel%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/2b5511c80142bca0018baddcbf277c1f.2h7prao94z40.webp" alt="截图"></p><h3 id="5-结论"><a href="#5-结论" class="headerlink" title="5. 结论"></a>5. 结论</h3><ol><li>支持sftp、kafka、rdb数据源</li><li>支持根据字段动态分区</li><li>kafka支持离线、实时处理</li><li>sftp不支持增量扫描</li><li>sftp不支持编码转换</li><li>sftp不支持文件级check、解码、回传</li></ol></div><div class="article-nav"><div class="article-prev"><a class="prev" rel="prev" href="/2023/11/01/CPU100%E6%8E%92%E6%9F%A5/"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item">CPU100排查</span> <span class="post-nav-item">上一篇</span></span></a></div><div class="article-next"><a class="next" rel="next" href="/2021/08/23/md%E8%AF%AD%E6%B3%95%E8%AE%B0%E5%BD%95/"><span class="title flex-center"><span class="post-nav-title-item">markdown语法记录</span> <span class="post-nav-item">下一篇</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div></div></div></div></div><div class="page-main-content-bottom"><footer class="footer"><div class="info-container"><div class="copyright-info info-item">&copy; <span>2021</span>&nbsp;-&nbsp; 2024&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">saber599</a></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="website-count info-item"><span id="busuanzi_container_site_uv">访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp; </span><span id="busuanzi_container_site_pv">总访问量&nbsp;<span id="busuanzi_value_site_pv"></span></span></div></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="tools-list"><li class="tools-item page-aside-toggle"><i class="fas fa-outdent"></i></li></ul></div></div><div class="right-bottom-side-tools"><div class="side-tools-container"><ul class="side-tools-list"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-expand-width flex-center"><i class="fas fa-arrows-alt-h"></i></li><li class="tools-item tool-dark-light-toggle flex-center"><i class="fas fa-moon"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list"><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li><li class="tools-item tool-scroll-to-top flex-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><aside class="page-aside"><div class="post-toc-wrap"><div class="post-toc"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6"><span class="nav-text">1. 前置条件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-sftp-gt-hive"><span class="nav-text">2. sftp-&gt;hive</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-%E5%9C%BA%E6%99%AF%E8%AF%B4%E6%98%8E"><span class="nav-text">2.1 场景说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-%E5%87%86%E5%A4%87"><span class="nav-text">2.2 准备</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-seatunnel%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99"><span class="nav-text">2.3 seatunnel配置文件编写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-%E5%A4%9A%E7%A7%8D%E6%96%B9%E5%BC%8F%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E5%88%B0hive"><span class="nav-text">2.4 多种方式加载数据到hive</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="nav-text">2.5 执行结果</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-kafka-gt-hive"><span class="nav-text">3. kafka-&gt;hive</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-%E5%9C%BA%E6%99%AF%E8%AF%B4%E6%98%8E"><span class="nav-text">3.1 场景说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-%E5%87%86%E5%A4%87"><span class="nav-text">3.2 准备</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-seatunnel%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99"><span class="nav-text">3.3 seatunnel配置文件编写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-%E5%8F%91%E9%80%81kafka%E6%B6%88%E6%81%AF"><span class="nav-text">3.4 发送kafka消息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-%E5%A4%9A%E7%A7%8D%E6%96%B9%E5%BC%8F%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E5%88%B0hive"><span class="nav-text">3.5 多种方式加载数据到hive</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-6-%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="nav-text">3.6 执行结果</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-rdb-gt-hive"><span class="nav-text">4. rdb-&gt;hive</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-%E5%9C%BA%E6%99%AF%E8%AF%B4%E6%98%8E"><span class="nav-text">4.1 场景说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-%E5%87%86%E5%A4%87"><span class="nav-text">4.2 准备</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-seatunnel%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99"><span class="nav-text">4.3 seatunnel配置文件编写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-%E5%A4%9A%E7%A7%8D%E6%96%B9%E5%BC%8F%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E5%88%B0hive"><span class="nav-text">4.4 多种方式加载数据到hive</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-5-%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="nav-text">4.5 执行结果</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E7%BB%93%E8%AE%BA"><span class="nav-text">5. 结论</span></a></li></ol></div></div></aside><div class="image-viewer-container"><img src=""></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fas fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fas fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.2/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.2/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.2/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.2/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.2/source/js/dark-light-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.2/source/js/local-search.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.2/source/js/code-copy.js"></script><div class="post-scripts pjax"><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.2/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.2/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.2/source/js/toc.js"></script></div><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.2/source/js/libs/pjax.min.js"></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=new Pjax({selectors:["head title",".page-container",".pjax"],history:!0,debug:!1,cacheBust:!1,timeout:0,analytics:!1,currentUrlFullReload:!1,scrollRestoration:!1});document.addEventListener("pjax:send",()=>{KEEP.utils.pjaxProgressBarStart()}),document.addEventListener("pjax:complete",()=>{KEEP.utils.pjaxProgressBarEnd(),e.executeScripts(document.querySelectorAll("script[data-pjax], .pjax script")),KEEP.refresh()})})</script></body></html>